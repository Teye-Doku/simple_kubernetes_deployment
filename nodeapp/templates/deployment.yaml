apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ .Chart.Name}}
spec:
  replicas: {{ .Values.deployment.replicaCount | default 1}}
  selector:
    matchLabels: 
       app: {{.Chart.Name}}
  template:
    metadata:
      name: {{ .Chart.Name }} 
      labels:
       app: {{.Chart.Name }}
    spec:
      containers:
        - name: {{.Chart.Name }}
          image: {{ .Values.deployment.image }}
          imagePullPolicy: {{ .Values.deployment.imagePullPolicy | default "IfNotPresent"}}
          ports:
            - name: http
              containerPort: {{ .Values.service.port }}
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /
              port: http  
              schema: HTTP
          readinessProbe:
            httpGet:
              path: /
              port: http
              schema: HTTP      
      {{- if .Values.affinity }}
      affinity:
        {{- toYaml .Values.affinity . | nindent 8 }}
      {{- end }} 
      {{- if .Values.tolerations }}
      tolerations:
        {{- toYaml .Values.tolerations . | nindent 8 }} 
      {{- end }}       
      {{- if  .Values.volumes}}
      volumes:
       {{- toYaml .Values.volumes . | nindent 8 }}
      {{- end }}